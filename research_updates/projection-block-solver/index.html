<!doctype html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<title>An efficient semi-implicit block second order solver for simulating two-phase flows - Makrand Khanwale</title>
<meta name="viewport" content="width=device-width, initial-scale=1">


  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png?v=1">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32.png?v=1">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16.png?v=1">
  <link rel="manifest" href="/favicon/site.webmanifest?v=1">
  
    <link rel="mask-icon" href="/favicon/safari-pinned-tab.svg?v=1" color="#ffffff">
    <link rel="shortcut icon" href="/favicon/favicon.ico?v=1">
    <meta name="msapplication-config" content="/favicon/browserconfig.xml?v=1">
  
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

<meta name="generator" content="Hugo 0.68.3" /><meta property="og:site_name" content="Makrand Khanwale">
  <meta property="og:title" content="An efficient semi-implicit block second order solver for simulating two-phase flows">
  <meta property="og:description" content="Our work on development of block projection semi-implicit schemes which are about 4 times faster than fully coupled schemes while preserving stability features.">
  <meta property="description" content="Our work on development of block projection semi-implicit schemes which are about 4 times faster than fully coupled schemes while preserving stability features.">
  <meta property="og:url" content="https://makrandak.github.io/research_updates/projection-block-solver/">
  <meta property="og:type" content="article">
  
    
      <meta property="og:image" content="https://makrandak.github.io/img/content/blog/projection-block-solver/progressive_zoom_gs_100dpi.png">
      <meta property="og:image:alt" content="progressive_zoom">
    
  
  <link rel="stylesheet" href="/css/bundle.min.d9e04ae08c9b3049b766dbd4aeab7d862c5ea1d13679b621490e0f5df5507497.css" integrity="sha256-2eBK4IybMEm3ZtvUrqt9hixeodE2ebYhSQ4PXfVQdJc="><link rel="stylesheet" href="/css/add-on.css">
</head>

  <body>
    

<header id="site-header">
  <nav id="site-nav">
    <h1 class="nav-title">
      <a href="/" class="nav">
        
          An efficient semi-implicit block second order solver for simulating two-phase flows
        
      </a>
    </h1>
    <menu id="site-nav-menu" class="flyout-menu menu">
      
        
          
          <a href="/" class="nav link"><i class='fa fa-home'></i> About</a>
        
      
        
          
          <a href="/research/" class="nav link"><i class='far fa-id-card'></i> Research</a>
        
      
        
          
          <a href="/experience/" class="nav link"><i class='far fa-id-card'></i> Experience</a>
        
      
        
          
          <a href="/publications/" class="nav link"><i class='far fa-id-card'></i> Publications</a>
        
      
        
          
          <a href="/contact/" class="nav link"><i class='far fa-envelope'></i> Contact</a>
        
      
      <a href="#share-menu" class="nav link share-toggle"><i class="fas fa-share-alt">&nbsp;</i>Share</a>
      <a href="#search-input" class="nav link search-toggle"><i class="fas fa-search">&nbsp;</i>Search</a>
    </menu>
    <a href="#search-input" class="nav search-toggle"><i class="fas fa-search fa-2x">&nbsp;</i></a>
    <a href="#share-menu" class="nav share-toggle"><i class="fas fa-share-alt fa-2x">&nbsp;</i></a>
    
    <a href="#site-nav" class="nav nav-toggle"><i class="fas fa-bars fa-2x"></i></a>
  </nav>
  <menu id="search" class="menu"><input id="search-input" class="search-input menu"></input><div id="search-results" class="search-results menu"></div></menu>
  
  
    <menu id="share-menu" class="flyout-menu menu">
      <h1>Share Post</h1>
      




  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmakrandak.github.io%2fresearch_updates%2fprojection-block-solver%2f&amp;title=An%20efficient%20semi-implicit%20block%20second%20order%20solver%20for%20simulating%20two-phase%20flows" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <p>LinkedIn</p>
          </a>
  

  
        <a href="mailto:?subject=Check%20out%20this%20post%20by Makrand%20Khanwale&amp;body=https%3a%2f%2fmakrandak.github.io%2fresearch_updates%2fprojection-block-solver%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
          <p>Email</p>
        </a>
  


    </menu>
  
</header>

    <div id="wrapper">
      <section id="site-intro" >
  <a href="/"><img src="https://makrandak.github.io/img/main/IMG_5171c.jpg" width="400" alt="Hugo Future Imperfect Slim" /></a>
  <header>
    <h1>Makrand A. Khanwale</h1>
  </header>
  <main>
    <p>Assistant Professor of Computational Fluid Dynamics (starting May 2026), <br>Technische Universität München</p>
  </main>
  
</section>

      <main id="site-main">
        
  <article class="post">
    <header>
  <div class="title">
    
      <h2><a href="/research_updates/projection-block-solver/">An efficient semi-implicit block second order solver for simulating two-phase flows</a></h2>
    
    
      <p>Our work on development of block projection semi-implicit schemes which are about 4 times faster than fully coupled schemes while preserving stability features.</p>
    
  </div>
  <div class="meta">
    <time datetime="2022-11-27 00:00:00 &#43;0000 UTC">November 27, 2022</time>
    <p>Makrand Khanwale</p>
    <p>4-Minute Read</p>
  </div>
</header>

    <div id="socnet-share">
      




  
        <a href="//www.linkedin.com/shareArticle?url=https%3a%2f%2fmakrandak.github.io%2fresearch_updates%2fprojection-block-solver%2f&amp;title=An%20efficient%20semi-implicit%20block%20second%20order%20solver%20for%20simulating%20two-phase%20flows" target="_blank" rel="noopener" class="nav share-btn linkedin">
            <p>LinkedIn</p>
          </a>
  

  
        <a href="mailto:?subject=Check%20out%20this%20post%20by Makrand%20Khanwale&amp;body=https%3a%2f%2fmakrandak.github.io%2fresearch_updates%2fprojection-block-solver%2f" target="_blank" class="nav share-btn email" data-proofer-ignore>
          <p>Email</p>
        </a>
  


    </div>
    <div class="content">
      <a href="/research_updates/projection-block-solver/" class="image">
    <img class="" src="https://makrandak.github.io/img/content/blog/projection-block-solver/progressive_zoom_gs_100dpi.png" alt="progressive_zoom">
  </a>
      <p><em>In picture above: Progressive zoomed in mesh for Rayleigh Taylor instability in the chaotic turbulent regime for the density ratio of 1:10.</em></p>
<h2 id="summary">Summary</h2>
<p>In this work we present a projection-based framework for solving a thermodynamically-consistent Cahn-Hilliard
Navier-Stokes system that models two-phase flows. In this work we extend the fully implicit method
presented in Khanwale et al. [A fully-coupled framework for solving Cahn-Hilliard Navier-Stokes equa-
tions: Second-order, energy-stable numerical methods on adaptive octree based meshes., Computer Physics Communications, 280 (2022), 108501], to a block iterative hybrid method. We use a projection-based semi-implicit time discretization for the Navier-Stokes and a fully-implicit time discretization for the Cahn-Hilliard equation.</p>
<p>We deploy this approach on a massively parallel numerical implementation using parallel octree-based adaptive meshes. The overall approach allows the use of relatively large time steps with much faster time-to-solve. We
present comprehensive numerical experiments showing detailed comparisons with results from
the literature for canonical cases, including the single bubble rise and Rayleigh-Taylor instability.</p>
<p>We make the framework called <a href="https://bitbucket.org/baskargroup/proteus/src/master/">[PROTEUS]</a> in which we implemented this solver open source.</p>
<hr>
<h2 id="highlights-of-the-work">Highlights of the work</h2>
<ul>
<li>A projection-based framework for solving a thermodynamically-consistent Cahn-
Hilliard Navier-Stokes system that models two-phase flows.</li>
<li>A block iterative, semi-implicit time discretization for the Navier-Stokes and a fully-
implicit time discretization for the Cahn-Hilliard equation.</li>
<li>Variational multiscale approach used to stabilize the decoupled pressure projection and
circumvent discrete inf-sup condition.</li>
<li>Pressure decoupling results in two linear positive semi-definite systems for velocity and
pressure, instead of the saddle point system.</li>
<li>An improved parallel numerical implementation using fast octree-based adaptive
meshes is presented.</li>
</ul>
<hr>
<h2 id="some-key-results">Some Key results:</h2>
<h3 id="chaotic-2d-rayleigh-taylor-instability">Chaotic 2D Rayleigh-Taylor instability</h3>
<p><img src="../../img/content/blog/projection-block-solver/q-criterion_big_crop_label.png" alt="RT2D">
In the Figure above: <em>Rayleigh-Taylor instability in 2D</em> : turbulent dynamics in Rayleigh Taylor instability for  for Atwood number of 0.82 (density ratio of 0.1).  (a) Shows the interface; (b) shows vorticity (c) Q-criterion (d) Q-criterion
threshold between 1.9 and 2</p>
<p>The figure shows vortex dynamics at long times in RTI.  We perform vortex identification using Q-
criterion. Figure shows turbulent instability in RTI. Panel (a) shows the complex mixing
structure of the interface in RTI in the
chaotic regime, panel (b) shows the vorticity in the
system after a very long time (4.962), panel (c) shows the Q-criterion at the same time.
To identify vortices we threshold the Q-criterion between 1.9 and 2 which is shown in
panel (d). It can be clearly seen that a myriad of small scale structures generated near the
filaments due to shear instability, and are resolved in our simulation. Note that as this is a 2D case,
therefore there is no vortex stretching, instead we have a redistribution of vorticity through the
non-linear convection. It is well known that there is a strong inverse cascade in the case of 2D turbulence and small scale structures combine to form large scale vortical structures. Therefore, it is even more important to resolve these near interface vortical structures which eventually feed in energy to the larger scales to correctly capture the large scale mixing in the system. This fine scale resolution has a profound influence on the higher-order statistics of Rayleigh-Taylor instability.</p>
<h3 id="performance-improvement">Performance improvement</h3>
<p><img src="../../img/content/blog/projection-block-solver/speedup.png" alt="RT3D"></p>
<p>In the Figure above:  Comparison of total solve time presented in this work in comparison to the fully coupled method in our fully coupled method.</p>
<p>The projection method presented in this paper in conjunction with the variational multiscale
approach, allows us to construct operators which are elliptic in each block. This allows for a selec-
tion of cheaper preconditioners compared to the pressure stabilized approach in pressure coupled methods. Additionally, the block projection approach also allows us to selectively provide implicit treat-
ment and decreases cost, e.g. Cahn-Hilliard operators are fully implicit, while the Navier-Stokes
operators are now semi-implicit, which linearizes the operator. We can observed that both methods scale
well, however the projection method is consistently cheaper than the fully-coupled method (see figure above). We
observe a speedup of roughly 2.5 to 4 times with the block projection method.</p>
<hr>
<h2 id="publication-based-on-this-approach">Publication based on this approach</h2>
<ul>
<li><strong>Makrand A. Khanwale</strong>, Kumar Saurabh, Masado Ishii, Hari Sundar, James A. Rossmanith, and Baskar Ganapathysubramanian. “A projection-based, semi-implicit time-stepping approach for the Cahn-Hilliard Navier-Stokes equations on adaptive octree meshes”. In: Journal of Computational Physics 475 (2023), p. 111874 <a href="https://arxiv.org/abs/2107.05123">[ARXIV]</a>|<a href="https://www.sciencedirect.com/science/article/pii/S0021999122009378">[LINK]</a></li>
</ul>

    </div>
    <footer>
      <div class="stats">
  
    <ul class="categories">
      
        
          <li><a class="article-terms-link" href="/categories/research/">research</a></li>
        
      
    </ul>
  
  
    <ul class="tags">
      
        
          <li><a class="article-terms-link" href="/tags/research/">research</a></li>
        
      
    </ul>
  
</div>

    </footer>
  </article>
  
    
  <article class="post">
    
    <div>
      <h2 id="say-something">Say Something</h2>
        <form id="comment-form" class="new-comment" method="POST">
          
          <h3 class='reply-notice hidden'>
            <span class='reply-name'></span>
          </h3>

          
          <input type="hidden" name="options[entryId]" value="b1623f1a51383f78cb0285b8393b225c">
          <input type='hidden' name='fields[replyThread]' value=''>
          <input type='hidden' name='fields[replyID]' value=''>
          <input type='hidden' name='fields[replyName]' value=''>

          
          <input required name='fields[name]' type='text' placeholder='Your Name'>
          <input name='fields[website]' type='text' placeholder='Your Website'>
          <input required name='fields[email]' type='email' placeholder='Your Email'>
          <textarea required name='fields[body]' placeholder='Your Message' rows='10'></textarea>

          
          

          
          <div class='submit-notice'>
            <strong class='submit-notice-text submit-success hidden'>Thanks for your comment! It will be shown on the site once it has been approved.</strong>
            <strong class='submit-notice-text submit-failed hidden'>Sorry, there was an error with your submission. Please make sure all required fields have been completed and try again.</strong>
          </div>

          
          <input type='submit' value='Submit' class='button'>
          <input type='submit' value='Submitted' class='hidden button' disabled>
          <input type='reset' value='Reset' class='button'>
        </form>
    </div>

    
    <div>
      <h2>Comments</h2>
    </div>
  </article>


  
  <div class="pagination">
    
    
      <a href="/research_updates/block-solver/" class="button right"><span>An adaptive block solver for simulating two-phase flows</span></a>
    
  </div>

      </main>
      <section id="site-sidebar">
  

  

  
</section>

      <footer id="site-footer">
  
      <ul class="socnet-icons">
        

        <li><a href="//github.com/makrandak" target="_blank" rel="noopener" title="GitHub" class="fab fa-github"></a></li>


<li><a href="//bitbucket.com/makrandak" target="_blank" rel="noopener" title="Bitbucket" class="fab fa-bitbucket"></a></li>








<li><a href="//www.linkedin.com/in/makrandkhanwale" target="_blank" rel="noopener" title="LinkedIn" class="fab fa-linkedin"></a></li>






















<li><a href="//scholar.google.com/citations?user=ai7GTW8AAAAJ%26hl%3den%26oi%3dao" target="_blank" rel="noopener" title="Google Scholar"><i class="ai ai-google-scholar"></i></a></li>
<li><a href="//orcid.org/0000-0002-8809-6320" target="_blank" rel="noopener" title="ORCID"><i class="ai ai-orcid"></i></a></li>
<li><a href="//researchgate.net/profile/Makrand_Khanwale3" target="_blank" rel="noopener" title="Research Gate"><i class="ai ai-researchgate"></i></a></li>


<li><a href="mailto:khanwale@stanford.edu" target="_blank" title="Email" class="far fa-envelope"></a></li>

      </ul>
  
  <p class="copyright">
    © 2022 Makrand Khanwale
      <br>
    Theme: <a href='https://github.com/pacollins/hugo-future-imperfect-slim' target='_blank' rel='noopener'>Hugo Future Imperfect Slim</a><br>A <a href='https://html5up.net/future-imperfect' target='_blank' rel='noopener'>HTML5 UP port</a> | Powered by <a href='https://gohugo.io/' title='0.68.3' target='_blank' rel='noopener'>Hugo</a>
  </p>
</footer>
<a id="back-to-top" href="#" class="fas fa-arrow-up fa-2x"></a>

      <script src="/js/highlight.js"></script>
    
    <script>hljs.initHighlightingOnLoad();</script><script src="/js/bundle.min.5955090a3253deadcd66071270aa2274dabe15ffc97094cec252d87b6f3f00bf.js" integrity="sha256-WVUJCjJT3q3NZgcScKoidNq&#43;Ff/JcJTOwlLYe28/AL8="></script>
    <script src="/js/add-on.js"></script>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'G-4B4L5S7149', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    </div>
  </body>
</html>
